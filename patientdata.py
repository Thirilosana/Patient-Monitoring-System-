import pymysql
import datetime
import time
import random

connection = pymysql.connect(
    host='localhost',
    user='root',
    password='',
    db='demo',
    charset='utf8mb4',
    cursorclass=pymysql.cursors.DictCursor,
    )
temperature = [
    97.844,
    98.114,
    98.474,
    98.87,
    99.014,
    99.032,
    99.032,
    98.42,
    98.51,
    98.402,
    98.51,
    98.6,
    98.42,
    98.582,
    98.582,
    98.618,
    98.672,
    98.672,
    98.852,
    98.726,
    98.564,
    98.618,
    98.546,
    98.546,
    98.816,
    98.834,
    98.852,
    98.87,
    98.906,
    98.816,
    98.816,
    98.906,
    99.104,
    99.104,
    99.392,
    99.518,
    99.752,
    99.518,
    100.364,
    100.436,
    100.4,
    100.832,
    100.58,
    100.832,
    100.598,
    100.436,
    100.598,
    100.418,
    100.238,
    100.328,
    100.454,
    100.706,
    100.742,
    100.724,
    100.67,
    100.472,
    100.328,
    100.112,
    100.094,
    100.112,
    99.932,
    99.968,
    99.968,
    99.752,
    99.734,
    100.508,
    100.742,
    101.03,
    100.85,
    100.148,
    100.31,
    100.31,
    99.968,
    99.68,
    100.202,
    100.148,
    99.878,
    100.004,
    100.076,
    99.968,
    100.058,
    100.112,
    100.418,
    100.58,
    100.67,
    100.256,
    99.752,
    99.86,
    99.428,
    99.338,
    99.428,
    99.608,
    99.59,
    99.95,
    99.968,
    99.914,
    99.986,
    100.418,
    100.472,
    100.526,
    ]

heart_rate = [
    58,
    56,
    54,
    54,
    53,
    57,
    62,
    57,
    56,
    55,
    55,
    55,
    59,
    59,
    58,
    59,
    60,
    59,
    63,
    63,
    58,
    56,
    58,
    58,
    58,
    56,
    57,
    55,
    57,
    56,
    58,
    58,
    57,
    57,
    55,
    57,
    58,
    55,
    56,
    55,
    55,
    54,
    54,
    55,
    54,
    54,
    54,
    54,
    54,
    54,
    53,
    53,
    53,
    53,
    53,
    53,
    54,
    54,
    55,
    55,
    55,
    55,
    56,
    54,
    53,
    53,
    54,
    53,
    54,
    53,
    53,
    54,
    53,
    53,
    54,
    54,
    53,
    53,
    60,
    53,
    51,
    59,
    55,
    54,
    54,
    54,
    54,
    53,
    53,
    53,
    53,
    54,
    53,
    53,
    53,
    52,
    53,
    52,
    51,
    51,
    ]

sugar = [
    148,
    85,
    183,
    89,
    137,
    116,
    78,
    115,
    197,
    125,
    110,
    168,
    139,
    189,
    166,
    100,
    118,
    107,
    103,
    115,
    126,
    99,
    196,
    119,
    143,
    125,
    147,
    97,
    145,
    117,
    109,
    158,
    88,
    92,
    122,
    103,
    138,
    102,
    90,
    111,
    180,
    133,
    106,
    171,
    159,
    180,
    146,
    71,
    103,
    105,
    103,
    101,
    88,
    176,
    150,
    73,
    187,
    100,
    146,
    105,
    84,
    133,
    44,
    141,
    114,
    99,
    109,
    109,
    95,
    146,
    100,
    139,
    126,
    129,
    79,
    62,
    131,
    112,
    113,
    74,
    83,
    101,
    137,
    110,
    106,
    100,
    136,
    107,
    80,
    123,
    81,
    134,
    142,
    144,
    92,
    71,
    93,
    122,
    ]

blood_pressure_diastolic = [
    110,
    150,
    180,
    90,
    70,
    60,
    50,
    100,
    90,
    140,
    ]
blood_pressure_systolic = [
    110,
    150,
    180,
    90,
    70,
    60,
    50,
    100,
    90,
    140,
    ]

try:
    with connection.cursor() as cursor:
        while True:
            sql = "UPDATE patientdata SET temperature=%s, heart_rate=%s, sugar=%s, bp_diastolic=%s, bp_systolic=%s WHERE patusername=%s"
            cursor.execute(sql, (
                random.choice(temperature),
                random.choice(heart_rate),
                random.choice(sugar),
                random.choice(blood_pressure_diastolic),
                random.choice(blood_pressure_systolic),
                'jack15',
                ))
            print (random.choice(temperature),
                   random.choice(heart_rate), random.choice(sugar),
                   random.choice(blood_pressure_diastolic),
                   random.choice(blood_pressure_systolic))
            connection.commit()
            time.sleep(10)
finally:
    connection.close()
